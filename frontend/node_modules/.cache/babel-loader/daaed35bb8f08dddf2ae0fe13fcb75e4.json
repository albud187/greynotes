{"ast":null,"code":"import axios from'axios';import*as actionTypes from'./actionTypes';export var authStart=function authStart(){return{type:actionTypes.AUTH_START};};export var authSuccess=function authSuccess(token){return{type:actionTypes.AUTH_SUCCESS,token:token};};export var authFail=function authFail(error){return{type:actionTypes.AUTH_FAIL,error:error};};export var logout=function logout(){localStorage.removeItem('token');localStorage.removeItem('expirationDate');localStorage.removeItem('userid');localStorage.removeItem('username');return{type:actionTypes.AUTH_LOGOUT};window.location.reload(false);};export var checkAuthTimeout=function checkAuthTimeout(expirationTime){return function(dispatch){setTimeout(function(){dispatch(logout());},expirationTime*1000);};};export var authLogin=function authLogin(username,password){return function(dispatch){dispatch(authStart());axios.post('http://127.0.0.1:8000/rest-auth/login/',{username:username,email:\"\",password:password}).then(function(res){var token=res.data.key;var expirationDate=new Date(new Date().getTime()+3600*1000);localStorage.setItem('token',token);localStorage.setItem('expirationDate',expirationDate);localStorage.setItem('username',username);dispatch(authSuccess(token));dispatch(checkAuthTimeout(3600));console.log(token);axios.get(\"http://127.0.0.1:8000/api/Tokens/\".concat(token,\"/\")).then(function(result){var userid=result.data.user;localStorage.setItem('userid',userid);});}).catch(function(err){dispatch(authFail(err));});};};export var authSignup=function authSignup(username,email,password1,password2){return function(dispatch){dispatch(authStart());axios.post('http://127.0.0.1:8000/rest-auth/registration/',{username:username,email:email,password1:password1,password2:password2}).then(function(res){var token=res.data.key;var expirationDate=new Date(new Date().getTime()+3600*1000);localStorage.setItem('token',token);localStorage.setItem('expirationDate',expirationDate);dispatch(authSuccess(token));dispatch(checkAuthTimeout(3600));}).catch(function(err){dispatch(authFail(err));});};};export var authCheckState=function authCheckState(){return function(dispatch){var token=localStorage.getItem('token');if(token===undefined){dispatch(logout());}else{var expirationDate=new Date(localStorage.getItem('expirationDate'));if(expirationDate<=new Date()){dispatch(logout());}else{dispatch(authSuccess(token));dispatch(checkAuthTimeout((expirationDate.getTime()-new Date().getTime())/1000));}}};};","map":{"version":3,"sources":["C:/Users/alfab/Documents/_Projects/greynotes/frontend/src/store/actions/auth.js"],"names":["axios","actionTypes","authStart","type","AUTH_START","authSuccess","token","AUTH_SUCCESS","authFail","error","AUTH_FAIL","logout","localStorage","removeItem","AUTH_LOGOUT","window","location","reload","checkAuthTimeout","expirationTime","dispatch","setTimeout","authLogin","username","password","post","email","then","res","data","key","expirationDate","Date","getTime","setItem","console","log","get","result","userid","user","catch","err","authSignup","password1","password2","authCheckState","getItem","undefined"],"mappings":"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","sourcesContent":["import axios from 'axios';\nimport * as actionTypes from './actionTypes';\n\nexport const authStart = () => {\n    return {\n        type: actionTypes.AUTH_START\n    }\n}\n\nexport const authSuccess = token => {\n    return {\n        type: actionTypes.AUTH_SUCCESS,\n        token: token\n    }\n}\n\nexport const authFail = error => {\n    return {\n        type: actionTypes.AUTH_FAIL,\n        error: error\n    }\n}\n\nexport const logout = () => {\n    localStorage.removeItem('token');\n    localStorage.removeItem('expirationDate');\n    localStorage.removeItem('userid');\n    localStorage.removeItem('username');\n\n    return {\n        type: actionTypes.AUTH_LOGOUT\n    };\n     window.location.reload(false)\n}\n\nexport const checkAuthTimeout = expirationTime => {\n    return dispatch => {\n        setTimeout(() => {\n            dispatch(logout());\n        }, expirationTime * 1000)\n    }\n}\n\nexport const authLogin = (username, password) => {\n    return dispatch => {\n        dispatch(authStart());\n        axios.post('http://127.0.0.1:8000/rest-auth/login/', {\n            username: username,\n            email:\"\",\n            password: password\n        })\n\n        .then(res => {\n            const token = res.data.key;\n            const expirationDate = new Date(new Date().getTime() + 3600 * 1000);\n            localStorage.setItem('token', token);\n            localStorage.setItem('expirationDate', expirationDate);\n            localStorage.setItem('username',username)\n            dispatch(authSuccess(token));\n            dispatch(checkAuthTimeout(3600));\n            console.log(token)\n\n            axios.get(`http://127.0.0.1:8000/api/Tokens/${token}/`)\n              .then(result =>{\n                const userid = result.data.user\n                localStorage.setItem('userid', userid);\n              })\n        })\n        .catch(err => {\n            dispatch(authFail(err))\n\n        })\n    }\n}\n\nexport const authSignup = (username, email, password1, password2) => {\n    return dispatch => {\n        dispatch(authStart());\n        axios.post('http://127.0.0.1:8000/rest-auth/registration/', {\n            username: username,\n            email: email,\n            password1: password1,\n            password2: password2\n        })\n        .then(res => {\n            const token = res.data.key;\n            const expirationDate = new Date(new Date().getTime() + 3600 * 1000);\n            localStorage.setItem('token', token);\n            localStorage.setItem('expirationDate', expirationDate);\n            dispatch(authSuccess(token));\n            dispatch(checkAuthTimeout(3600));\n        })\n        .catch(err => {\n            dispatch(authFail(err))\n        })\n    }\n}\n\nexport const authCheckState = () => {\n    return dispatch => {\n        const token = localStorage.getItem('token');\n        if (token === undefined) {\n            dispatch(logout());\n        } else {\n            const expirationDate = new Date(localStorage.getItem('expirationDate'));\n            if ( expirationDate <= new Date() ) {\n                dispatch(logout());\n            } else {\n                dispatch(authSuccess(token));\n                dispatch(checkAuthTimeout( (expirationDate.getTime() - new Date().getTime()) / 1000) );\n            }\n        }\n    }\n}\n"]},"metadata":{},"sourceType":"module"}